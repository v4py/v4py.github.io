<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Working with online resources</title>
  <meta name="description" content="# Working with online resources# How to work with this material* There is always first a text telling you what to do  * So first try to do it yourself withou...">

  <link rel="canonical" href="https://v4py.github.io//src/rest.html">
  <link rel="alternate" type="application/rss+xml" title="An Introduction to Python for Linguists" href="https://v4py.github.io//feed.xml">

  <meta property="og:url"         content="https://v4py.github.io//src/rest.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Working with online resources" />
<meta property="og:description" content="# Working with online resources# How to work with this material* There is always first a text telling you what to do  * So first try to do it yourself withou..." />
<meta property="og:image"       content="https://v4py.github.io/images/v4py_logo_wide.svg" />

<meta name="twitter:card" content="summary">


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "https://v4py.github.io//src/rest.html",
  "headline": "Working with online resources",
  "datePublished": "2020-03-29T00:12:24+01:00",
  "dateModified": "2020-03-29T00:12:24+01:00",
  "description": "# Working with online resources# How to work with this material* There is always first a text telling you what to do  * So first try to do it yourself withou...",
  "author": {
    "@type": "Person",
    "name": "David Lukeš, Rudolf Rosa"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://v4py.github.io/",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://v4py.github.io/",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/assets/css/styles.css">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/images/v4py_logo.svg">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<!-- (mostly) copied from nbconvert configuration -->
<!-- https://github.com/jupyter/nbconvert/blob/master/nbconvert/templates/html/mathjax.tpl -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true },
    },
    
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML' async></script>


  <!-- DOM updating function -->
  <script src="/assets/js/page/dom-update.js"></script>

  <!-- Selectors for elements on the page -->
  <script src="/assets/js/page/documentSelectors.js"></script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js" async></script>
  <script src="/assets/js/page/anchors.js" async></script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->



  <!-- Load the auto-generating TOC (non-async otherwise the TOC won't load w/ turbolinks) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.8.1/tocbot.min.js" async></script>
  <script src="/assets/js/page/tocbot.js"></script>

  <!-- Google analytics -->
  


  <!-- Clipboard copy button -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  
<script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
    
function dict2param(dict) {
    params = Object.keys(dict).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(dict[k])
    });
    return params.join('&')
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return dict2param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = document.querySelectorAll("a").forEach(function(link) {
    var href = link.href;
    // If the link is an internal link...
    if (href.search("https://v4py.github.io") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['jupyterhub'] = hub;
      } else {
        // Create the REST params
        params = {'jupyterhub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + dict2param(params);
      link.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}


// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    jupyterHubUrl = rest['jupyterhub'];
    var hubType = null;
    var hubUrl = null;
    if (jupyterHubUrl !== undefined) {
      hubType = 'jupyterhub';
      hubUrl = jupyterHubUrl;
    }

    if (hubType !== null) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);

      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      var interactButtons = document.querySelectorAll("button.interact-button")
      var lastButton = interactButtons[interactButtons.length-1];
      var link = lastButton.parentElement;

      // If we've already run this, skip the link updating
      if (link.nextElementSibling !== null) {
        return;
      }

      // Update the link and add context div
      var href = link.getAttribute('href');
      if (lastButton.id === 'interact-button-binder') {
        // If binder links exist, we need to re-work them for jupyterhub
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // If localhost, assume we're working from a local Jupyter server and remove `/hub`
          first = [hubUrl, 'git-sync'].join('/')
        } else {
          first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
        }
        href = first + '?' + binder2Jupyterhub(href);
      } else {
        // If interact button isn't binderhub, assume it's jupyterhub
        // If JupyterHub links, we only need to replace the hub url
        href = href.replace("https://jupyter.korpus.cz", hubUrl);
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // Assume we're working from a local Jupyter server and remove `/hub`
          href = href.replace("/hub/user-redirect", "");
        }
      }
      link.setAttribute('href', decodeURIComponent(href));

      // Add text after interact link saying where we're launching
      hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
      link.insertAdjacentHTML('afterend', '<div class="interact-context">on ' + hubUrlNoHttp + '</div>');

      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>


  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.6/lunr.min.js" async></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>

  <!-- Load JS that depends on site variables -->
  <script src="/assets/js/page/copy-button.js" async></script>

  <!-- Hide cell code -->
  <script src="/assets/js/page/hide-cell.js" async></script>

  <!-- Printing the screen -->
  <!-- Include nbinteract for interactive widgets -->
<script src="https://printjs-4de6.kxcdn.com/print.min.js" async></script>
<script>
printContent = () => {
    // MathJax displays a second version of any math for assistive devices etc.
    // This prevents double-rendering in the PDF output.
    var ignoreAssistList = [];
    assistives = document.querySelectorAll('.MathJax_Display span.MJX_Assistive_MathML').forEach((element, index) => {
        var thisId = 'MathJax-assistive-' + index.toString();
        element.setAttribute('id', thisId);
        ignoreAssistList.push(thisId)
    });

    // Print the actual content object
    printJS({
        printable: 'textbook_content',
        type: 'html',
        css: "/assets/css/styles.css",
        style: "#textbook_content {padding-top: 40px};",
        scanStyles: false,
        targetStyles: ["*"],
        ignoreElements: ignoreAssistList,
        documentTitle: "An Introduction to Python for Linguists"
    })
};

initPrint = () => {
    document.querySelector('#interact-button-print').addEventListener('click', printContent)
}

initFunction(initPrint)
</script>

</head>

  <body>
    <!-- Include the ThebeLab config so it gets reloaded on each page -->
    <script type="text/x-thebe-config">{
    requestKernel: true,
    binderOptions: {
    repo: "v4py/v4py.github.io",
    ref: "master",
    },
    codeMirrorConfig: {
    theme: "abcdef",
    mode: "python"
    },
    kernelOptions: {
    kernelName: "python3",
    path: ""
    }
}
</script>

    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="https://v4py.github.io"><img src="/images/v4py_logo_wide.svg" class="textbook_logo" id="sidebar-logo" alt="textbook logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">An Introduction to Python for Linguists</h2>
  <ul class="c-sidebar__chapters">
    
      
      
        <li><h2 class="c-sidebar__title">Table of contents</li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/intro">
        <a class="c-sidebar__entry"
          href="/intro.html"
        >
          
            1.
          
          Introduction
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/basics">
        <a class="c-sidebar__entry"
          href="/basics.html"
        >
          
            2.
          
          A tour of Python and NLTK
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/unicode">
        <a class="c-sidebar__entry"
          href="/unicode.html"
        >
          
            3.
          
          Text inside the computer
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/data">
        <a class="c-sidebar__entry"
          href="/data.html"
        >
          
            4.
          
          Getting your data into Python
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/rest">
        <a class="c-sidebar__entry"
          href="/rest.html"
        >
          
            5.
          
          Working with online resources
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/case">
        <a class="c-sidebar__entry"
          href="/case.html"
        >
          
            6.
          
          Case studies
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/case/collocations">
              <a class="c-sidebar__entry"
                href="/case/collocations.html"
              >
                
                  6.1
                
                Determining collocation strength
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/case/keywords">
              <a class="c-sidebar__entry"
                href="/case/keywords.html"
              >
                
                  6.2
                
                Keyword analysis: Donald Trump's speeches
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/outro">
        <a class="c-sidebar__entry"
          href="/outro.html"
        >
          
            7.
          
          Parting words
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">Links</li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="https://ufal.mff.cuni.cz/">
        <a class="c-sidebar__entry"
          href="https://ufal.mff.cuni.cz/"
        >
          
          ÚFAL MFF UK
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="https://korpus.cz/">
        <a class="c-sidebar__entry"
          href="https://korpus.cz/"
        >
          
          Czech National Corpus
        </a>
      </li>

      
      

      

      
      

      

      
    
  </ul>
  <p class="sidebar_footer">Sponsored by <a href="https://www.visegradfund.org/">Visegrad Fund</a> grant nr. 21820079 "Training Digital Scholars: Knowledge Exchange between V4 and Austria"</p>
</nav>

      
      <div class="c-topbar" id="top-navbar">
  <!-- We show the sidebar by default so we use .is-active -->
  <div class="c-topbar__buttons">
    <button
      id="js-sidebar-toggle"
      class="hamburger hamburger--arrowalt is-active"
    >
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="buttons">
<div class="download-buttons-dropdown">
    <button id="dropdown-button-trigger" class="interact-button"><img src="/assets/images/download-solid.svg" alt="Download" /></button>
    <div class="download-buttons">
        
        <a id="interact-button-print"><button id="interact-button-download" class="interact-button">.pdf</button></a>
    </div>
</div>


</div>

  </div>
  <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
  <aside class="sidebar__right">
    <header><h4 class="nav__title"><img src="/assets/images/list-solid.svg" alt="Search" />   On this page</h4></header>
    <nav class="onthispage">
    </nav>
  </aside>
  <a href="/search.html" class="topbar-right-button" id="search-button">
    <img src="/assets/images/search-solid.svg" alt="Search" />
  </a>
</div>

      <main class="c-textbook__page" tabindex="-1">
            <div class="c-textbook__content" id="textbook_content">
              <h1 id="working-with-online-resources">Working with online resources</h1>

<h1 id="how-to-work-with-this-material">How to work with this material</h1>

<ul>
  <li>There is always first a text telling you what to do
    <ul>
      <li>So first try to do it yourself without looking at the code</li>
    </ul>
  </li>
  <li>Below the text, there is always the code that does the task
    <ul>
      <li>So look at the code and try to run it and understand it</li>
      <li>Try to play with it</li>
      <li>Try to change it and see what happens, this will help you to better
understand it</li>
    </ul>
  </li>
  <li>Sometimes, there are also suggestions for additional exercises
    <ul>
      <li>These are typically not accompanied by solutions</li>
      <li>Try to solve these yourself if you wish</li>
    </ul>
  </li>
  <li>As programmers say: Move fast and break things
    <ul>
      <li>Don’t think too long about how to do something</li>
      <li>Just try to do it somehow, run the code and see what happens</li>
      <li>Don’t be afraid to break stuff; you will probably not break anything
important :-)</li>
    </ul>
  </li>
  <li>There are always more ways to do it
    <ul>
      <li>So you may create a different piece of code than the sample code
provided here</li>
      <li>And that’s a good thing</li>
      <li>Any code that does the job is good</li>
      <li>Additionally, code that does the job and is efficient and elegant is
great code
        <ul>
          <li>But in most cases, any code that works is just fine :-)</li>
        </ul>
      </li>
      <li>The codes provided here are just some examples of good code, but
take them just as examples, feel free to diverge from them!</li>
    </ul>
  </li>
</ul>

<p>Now, let’s get to the actual class on:</p>

<h1 id="opening-resources-from-internet">Opening resources from Internet</h1>

<ul>
  <li>Let’s “download” the document from http://p.nikde.eu</li>
</ul>

<h2 id="uncool-variant-copy-paste">Uncool variant: copy-paste</h2>

<ol>
  <li>Go to http://p.nikde.eu</li>
  <li>Copy the text</li>
  <li>Paste it into a variable</li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">copypaste</span><span class="o">=</span><span class="s">"""Všichni lidé rodí se svobodní a sobě rovní co do důstojnosti a práv.
Všetci ľudia sa rodia slobodní a sebe rovní, čo sa týka ich dostojnosti a práv.
Wszyscy ludzie rodzą się wolni i równi pod względem swej godności i swych praw.
Tutti gli esseri umani nascono liberi ed eguali in dignità e diritti.
Todos los seres humanos nacen libres e iguales en dignidad y derechos.
Alle Menschen sind frei und gleich an Würde und Rechten geboren.
Kaikki ihmiset syntyvät vapaina ja tasavertaisina arvoltaan ja oikeuksiltaan.
Все люди рождаются свободными и равными в своем достоинстве и правах.
Всички хора се раждат свободни и равни по достойнство и права.
All human beings are born free and equal in dignity and rights."""</span>
</code></pre></div></div>

<p>```python tags=[“full_width”]
print(copypaste)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## Cool variant: get the text from the webpage using Python!

1. `import` the `requests` module
2. use its `get` method to get the contents of the webpage, using the
   webpage's URL as a parameter
   * we will also have to specify the encoding of the response
3. find the text of the webpage inside the `text` field of the response

```python
import requests
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">my_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"http://p.nikde.eu"</span><span class="p">)</span>
<span class="n">my_response</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s">'utf8'</span>
</code></pre></div></div>

<p>```python tags=[“full_width”]
print(my_response.text)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
### Additional exercises 1
* count the number of characters in the text, i.e. the `len`gth of the
  text
* split the text into lines (at each newline character `\n`)
* see e.g. the first and the last line

```python
len(my_response.text)
</code></pre></div></div>

<p>```python tags=[“full_width”]
lines = my_response.text.split(‘\n’)
lines</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
```python tags=["full_width"]
print(lines[0])
print(lines[-1])
</code></pre></div></div>

<h1 id="rest-apis">REST APIs</h1>

<ul>
  <li>dynamic resources (unlike the static document from previous example,
which is always the same)</li>
  <li>tools available on the internet for automated use
    <ul>
      <li>NLP tools (translation, morphological analysis, keyword
extraction…)</li>
      <li>jokes, images, weather information…</li>
      <li>we will look at 5 REST APIs here</li>
    </ul>
  </li>
  <li>the meaning of the shortcuts is not important
    <ul>
      <li>REST stands for REpresentational State Transfer</li>
      <li>API stands for Application Programming Interface</li>
    </ul>
  </li>
  <li>to use a tool, you need to know:
    <ul>
      <li>its URL (<code class="language-plaintext highlighter-rouge">http://something.com/some/more/stuff</code>)</li>
      <li>its parameters (it may be e.g. <code class="language-plaintext highlighter-rouge">input</code> for input text)</li>
      <li>the method to use (<code class="language-plaintext highlighter-rouge">GET</code> or <code class="language-plaintext highlighter-rouge">POST</code>)
        <ul>
          <li>often both are allowed, or just try</li>
        </ul>
      </li>
      <li>and sometimes there are some more complications</li>
      <li>for the static document, there was just the URL (there are no
parameters)</li>
    </ul>
  </li>
  <li>ideally, the tool has good documentation explaining how to use it
    <ul>
      <li>but the world is not ideal</li>
    </ul>
  </li>
  <li>The requests module makes an educated guess as of the encoding of the
response. If it guesses wrong, you can set the encoding manually:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">response.encoding='utf8'</code></li>
    </ul>
  </li>
</ul>

<h2 id="1st-rest-api-machine-translation-transformer">1st REST API: Machine translation (Transformer)</h2>

<ul>
  <li>Look at <a href="https://lindat.mff.cuni.cz/services/translation/">LINDAT
Translation</a></li>
  <li>Try it out in your browser</li>
  <li>Try to look at the documentation in the Docs tab
    <ul>
      <li>Try to figure out what URL, parameters and method you need to use</li>
    </ul>
  </li>
</ul>

<h3 id="url">URL</h3>

<p>The URL is composed of:</p>

<ul>
  <li>the server part: <code class="language-plaintext highlighter-rouge">https://lindat.mff.cuni.cz/</code></li>
  <li>the base URL: <code class="language-plaintext highlighter-rouge">/services/translation/api/v2</code></li>
  <li>the endpoint: <code class="language-plaintext highlighter-rouge">/models/{model}</code>
    <ul>
      <li>this says “Send text to be processed by the selected model”</li>
      <li>so instead of <code class="language-plaintext highlighter-rouge">{model}</code> we have to put e.g. <code class="language-plaintext highlighter-rouge">en-cs</code> for the
English-Czech model</li>
    </ul>
  </li>
  <li>the URL parts are to be joined by slashes:
<code class="language-plaintext highlighter-rouge">SERVER/BASE/ENDPOINT/MODEL</code></li>
</ul>

<p>So the full URL is:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">url</span> <span class="o">=</span> <span class="s">"https://lindat.mff.cuni.cz/services/translation/api/v2/models/en-cs"</span>
</code></pre></div></div>

<h3 id="parameters">Parameters</h3>

<p>There are several parameters to set, but we only need one:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">input_text</code> text to translate</li>
  <li>we alread specified the <code class="language-plaintext highlighter-rouge">model</code> in the URL path</li>
  <li>and the model implies the source and target languages (<code class="language-plaintext highlighter-rouge">src</code>, <code class="language-plaintext highlighter-rouge">tgt</code>)</li>
</ul>

<p>We can put the parameters (one parameter in this case) into a dict:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s">"input_text"</span><span class="p">:</span> <span class="s">"All humans are born equal."</span><span class="p">}</span>
</code></pre></div></div>

<h3 id="method">Method</h3>

<ul>
  <li>The most typical methods are <code class="language-plaintext highlighter-rouge">GET</code> and <code class="language-plaintext highlighter-rouge">POST</code>.</li>
  <li>The documentation clearly states that to process text by a translation
model, we need to use the <code class="language-plaintext highlighter-rouge">POST</code> method.</li>
  <li>This means that instead of <code class="language-plaintext highlighter-rouge">requests.get()</code>, which we used in the
previous example, we will use <code class="language-plaintext highlighter-rouge">requests.post()</code></li>
</ul>

<h3 id="try-it-out">Try it out!</h3>

<p>We now have the URL and parameters, we know which method to use, so shoot!</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">translation_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">translation_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre></div></div>

<p>The response does not look very nice. That’s because it is encoded in
JSON. What we see is actually a JSON equivalent of a Python list.</p>

<p>So, what we need to do is to use <code class="language-plaintext highlighter-rouge">translation_response.json()</code> instead
of <code class="language-plaintext highlighter-rouge">translation_response.text</code>, so that instead of taking the text
representation of the JSON data, we parse the JSON data and get their
Python representation:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">translation_response_parsed</span> <span class="o">=</span> <span class="n">translation_response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">translation_response_parsed</span><span class="p">)</span>
</code></pre></div></div>

<p>That’s better, right? What we now have is a Python list, which means we
can easily print just its first element:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">translation_response_parsed</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div></div>

<p>And that’s it, we’re done! :-)</p>

<h3 id="changing-the-parameters">Changing the parameters</h3>

<p>REST APIs are dynamic, so we can get translated any text we want,
between any languages supported by the API! So let’s change the
parameters, so that we e.g.:</p>

<ul>
  <li>Translate the text “I like trains very much.”</li>
  <li>From English to French</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#import requests
</span><span class="n">url</span> <span class="o">=</span> <span class="s">"https://lindat.mff.cuni.cz/services/translation/api/v2/models/en-fr"</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s">"input_text"</span><span class="p">:</span> <span class="s">"I like trains very much."</span><span class="p">}</span>
<span class="n">translation_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">translation_response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div></div>

<h3 id="lets-put-that-into-a-function">Let’s put that into a function!</h3>

<ul>
  <li>the first version of the function shall have just one parameter
    <ul>
      <li>the text to translate</li>
    </ul>
  </li>
  <li>it needs to set the URL and parameters, do the request, set the
response encoding, and return the response text</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s">"https://lindat.mff.cuni.cz/services/translation/api/v2/models/en-cs"</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s">"input_text"</span><span class="p">:</span> <span class="n">text</span><span class="p">}</span>
    <span class="n">translation_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
    <span class="n">translation_response</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s">'utf8'</span>
    <span class="n">translation_response_parsed</span> <span class="o">=</span> <span class="n">translation_response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">translation_response_parsed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<p>Now let’s see how this works:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">text</span> <span class="o">=</span> <span class="s">"I had a good breakfast."</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">translate</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">translate</span><span class="p">(</span><span class="s">"I really love trains."</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">translate</span><span class="p">(</span><span class="s">"My hovercraft is full of eels!"</span><span class="p">))</span>
</code></pre></div></div>

<h3 id="improving-the-function">Improving the function</h3>

<p>Now let’s improve the function by also making the source and target
languages aparmetrizable!</p>

<p>The improved function should have the following three parameters:</p>

<ul>
  <li>the text to translate</li>
  <li>the source language code (e.g. “en”)</li>
  <li>the target language code (e.g. “fr”)</li>
</ul>

<p>There should also be some default values for the parameters, so that the
function can also be called with only the text specified.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">target_language</span><span class="o">=</span><span class="s">"cs"</span><span class="p">,</span> <span class="n">source_language</span><span class="o">=</span><span class="s">"en"</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">f</span><span class="s">"https://lindat.mff.cuni.cz/services/translation/api/v2/models/{source_language}-{target_language}"</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s">"input_text"</span><span class="p">:</span> <span class="n">text</span><span class="p">}</span>
    <span class="n">translation_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
    <span class="n">translation_response_parsed</span> <span class="o">=</span> <span class="n">translation_response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">translation_response_parsed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<p>And now let’s see various ways in which this can be used:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">translate</span><span class="p">(</span><span class="s">"I had a good breakfast."</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">translate</span><span class="p">(</span><span class="s">"I had a good breakfast."</span><span class="p">,</span> <span class="s">"fr"</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">translate</span><span class="p">(</span><span class="s">"Jedu vlakem do Prahy."</span><span class="p">,</span> <span class="s">"en"</span><span class="p">,</span> <span class="s">"cs"</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">translate</span><span class="p">(</span><span class="n">source_language</span><span class="o">=</span><span class="s">"cs"</span><span class="p">,</span> <span class="n">target_language</span><span class="o">=</span><span class="s">"en"</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">"Jedu vlakem do Prahy."</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">translate</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</code></pre></div></div>

<h3 id="additional-exercises-2">Additional exercises 2</h3>

<ul>
  <li>Try to make it work correctly with input text consisting of multiple
sentences.</li>
  <li>Try to translate the input text into all available target languages at
once.</li>
  <li>Explore other information that the response object contains.</li>
</ul>

<h2 id="2nd-rest-api-jokes">2nd REST API: Jokes</h2>

<ul>
  <li><a href="http://www.icndb.com/">The Internet Chuck Norris Database</a> provides a
REST API
    <ul>
      <li>This is a database of Chuck Norris jokes</li>
      <li>The API returns random Chuck Norris jokes</li>
      <li>See http://www.icndb.com/api/</li>
      <li>Try to figure out the URL, method, and parameters</li>
    </ul>
  </li>
</ul>

<h3 id="how-to-use-it">How to use it</h3>

<ul>
  <li>The full URL is <code class="language-plaintext highlighter-rouge">http://api.icndb.com/jokes/random</code></li>
  <li>There are some optional parametrs, so let’s ignore them now</li>
  <li>The method to use is GET</li>
  <li>So the call will actually be very similar to the first example with
getting the static webpage from the internet:</li>
</ul>

<p>```python tags=[“output_scroll”]
url = “http://api.icndb.com/jokes/random”
joke = requests.get(url)
print(joke.text)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
The output is again in JSON, but this time, it is a bit more complex.
The API documentation does explain the format, so try to extract just
the joke text from the response.

```python tags=["output_scroll"]
joke_parsed = joke.json()
joke_text = joke_parsed['value']['joke']
print(joke_text)
</code></pre></div></div>

<h3 id="turning-it-into-a-function">Turning it into a function</h3>

<ul>
  <li>Let’s again create a function that calls the REST API.</li>
  <li>It will have no parameters.</li>
  <li>But as the REST API always returns a random joke, repeated calls of
the function will return different results.
    <ul>
      <li>So it is even more dynamic than the translation service, which for a
fixed input always returns the same result.</li>
    </ul>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">joke</span><span class="p">():</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s">"http://api.icndb.com/jokes/random"</span>
    <span class="n">joke_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">joke_parsed</span> <span class="o">=</span> <span class="n">joke_response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="n">joke_text</span> <span class="o">=</span> <span class="n">joke_parsed</span><span class="p">[</span><span class="s">'value'</span><span class="p">][</span><span class="s">'joke'</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">joke_text</span>
</code></pre></div></div>

<p>Invoke the function repeatedly and observe how it produces different
outputs.</p>

<p>```python tags=[“output_scroll”]
print(joke())</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
```python tags=["output_scroll"]
print(joke())
</code></pre></div></div>

<p>```python tags=[“output_scroll”]
print(joke())</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
### Adding parameters

* So far, we have ignored the option to specify some parameters for the
  REST API call.
* Actually, the only thing you can do is change the name of the main
  character in the jokes.
* So let's do it!

```python tags=["output_scroll"]
params = {"firstName": "David", "lastName": "Lukes"}
joke_response = requests.get(url, params)
print(joke_response.json()['value']['joke'])
</code></pre></div></div>

<p>Now, let’s update our function to also allow specifying these
parameters.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">joke</span><span class="p">(</span><span class="n">firstName</span> <span class="o">=</span> <span class="s">'Chuck'</span><span class="p">,</span> <span class="n">lastName</span> <span class="o">=</span> <span class="s">'Norris'</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s">"http://api.icndb.com/jokes/random"</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">"firstName"</span><span class="p">:</span> <span class="n">firstName</span><span class="p">,</span> <span class="s">"lastName"</span><span class="p">:</span> <span class="n">lastName</span><span class="p">}</span>
    <span class="n">joke_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
    <span class="n">joke_parsed</span> <span class="o">=</span> <span class="n">joke_response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="n">joke_text</span> <span class="o">=</span> <span class="n">joke_parsed</span><span class="p">[</span><span class="s">'value'</span><span class="p">][</span><span class="s">'joke'</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">joke_text</span>
</code></pre></div></div>

<p>And let’s run it with various parameters.</p>

<p>```python tags=[“output_scroll”]
print(joke())</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
```python tags=["output_scroll"]
print(joke('Rudolf', 'Rosa'))
</code></pre></div></div>

<p>```python tags=[“output_scroll”]
print(joke(‘yo’, ‘mama’))</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
### Additional exercises 3

* Try to connect the joke API with the translation API
  * Get a random joke
  * Translate it to another language
  * Print the translated joke

## 3rd REST API: Cat images

* Let's see some cats!
* Try to search in Google for a cat image REST API
* You may find one e.g. at https://cataas.com/
* The simplest way to use it is to just ask it for a random cat by
  getting `https://cataas.com/cat`

```python tags=["output_scroll"]
url = "https://cataas.com/cat"
r = requests.get(url)
print(r.text[:300])
</code></pre></div></div>

<p>The output is not very nice. Well, it is an image, so that’s binary
data, not a text which can be meaningfully printed.</p>

<p>In Python, we can disply the data using the <code class="language-plaintext highlighter-rouge">Image()</code> function from the
<code class="language-plaintext highlighter-rouge">IPython.core.display</code> package.  And as the response is not textual, we
again need to use a different view on it, this time taking its content
directly from <code class="language-plaintext highlighter-rouge">response.content</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://cataas.com/cat"</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="additional-exercises-4">Additional exercises 4</h3>

<ul>
  <li>Try to run the code above repeatedly to get a different cat each time.</li>
  <li>Try to put it into a function.</li>
  <li>Check out the options and parameters in the documentation to try
getting more specific cats than just plain random.</li>
</ul>

<h2 id="4th-rest-api-named-entities-nametag">4th REST API: Named entities (NameTag)</h2>

<ul>
  <li>Look at the <a href="http://lindat.mff.cuni.cz/services/nametag/">LINDAT
NameTag</a> tool for named
entity detection and recognition</li>
  <li>Try out the tool using the web interface
    <ul>
      <li>Select the English model</li>
      <li>Put in e.g. some newspaper text</li>
      <li>Explore the results</li>
    </ul>
  </li>
  <li>Look at the REST API Documentation of the tool
    <ul>
      <li>Try to find out how to use it (URL, method, parameters)</li>
      <li>Try to call the tool on a sample sentence, e.g.:</li>
    </ul>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sentence</span> <span class="o">=</span> <span class="s">"David Lukes teaches Python in Prague."</span>
</code></pre></div></div>

<ul>
  <li>This time, we can use either GET or POST as we wish. In such cases,
using POST is usually better, since GET is more limited (especially in
the maximum input size).</li>
  <li>There is some clever model selection and guessing, which seems to be
broken, so you need to use the full model name.</li>
  <li>The default output is XML, which is fine if you know how to work with
XML. As we do not cover that in our course, we will use the vertical
output instead.</li>
</ul>

<p>```python tags=[“output_scroll”]
url = “http://lindat.mff.cuni.cz/services/nametag/api/recognize”</p>

<p>parameters = {
    “data”: sentence,
    “model”: “english-conll-140408”,
    “output”: “vertical”
}</p>

<p>res = requests.get(url, parameters)</p>

<p>print(res.text)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
We can see that the output is again JSON, with the `result` field
containing the result, so let's print only that one.

```python
result = res.json()['result']
print(result)
</code></pre></div></div>

<p>The result lists the named entities found in the text, together with
their start and end positions and their types.  We can see that the
result actually uses another format, tab-spearated values. This is fine
for printing, but for further processing, we would need to split it.
So, let’s split the result into individual lines, split these lines into
the fields, and let’s print only the entity types.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">):</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<h3 id="additional-exercises-5">Additional exercises 5</h3>

<ul>
  <li>Try to wrap it into a function</li>
  <li>Try to parametrize it for the language (but only English and Czech are
supported)</li>
  <li>Try to visualize the outputs somehow, e.g. by prefixing each named
entity with its type:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">PER David Lukes teaches PER Python in LOC Prague.</code></li>
    </ul>
  </li>
</ul>

<h2 id="5th-rest-api-morphological-analysis-udpipe">5th REST API: Morphological analysis (UDPipe)</h2>

<ul>
  <li>The last tool we will look at is
<a href="https://lindat.mff.cuni.cz/services/udpipe/">UDPipe</a></li>
  <li>It performs tokenization, lemmatization, morphological tagging, and
dependency syntax parsing.</li>
  <li>It follows the <a href="http://universaldependencies.org">Universal Dependencies</a> standards</li>
  <li>It supports something like 50 languages!</li>
  <li>As usual:
    <ul>
      <li>Check out the tool online</li>
      <li>Try playing with it using the web-based demo, probably copy-pasting
some texts from news websites</li>
      <li>Try to figure out how to use its REST API and then try to use it</li>
      <li>The syntactic parsing output is hard to use, so let’s just stick to
tokenization and tagging</li>
    </ul>
  </li>
</ul>

<p>```python tags=[“output_scroll”]
url = “http://lindat.mff.cuni.cz/services/udpipe/api/process”</p>

<p>parameters = {
    “data”: “All human beings are born free and equal in dignity and rights. I like trains.”,
    “model”: “english”,
    “tokenizer”: 1,
    “tagger”: 1,
}</p>

<p>response = requests.post(url, parameters)
print(response.text)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
### CoNLL-U

Similarly to NameTag, we can see that the result is in the `result`
field of the returned JSON, again using a tab-separated text format; in
this case, this is actually the standard [CoNLL-U
format](http://universaldependencies.org/docs/format.html), which is
defined and used with Universal Dependencies.

Let's parse the JSON and print the result first.

```python tags=["output_scroll"]
print(response.json()['result'])
</code></pre></div></div>

<p>This is good for viewing the result, but it needs some further
processing to be usable in Python.  We could parse the result manually
using some splitting and such, as we did with NameTag, but now the
format is more complex and has some special properties and special
rules, so it is not as trivial to process as the NameTag output format
(but it is still simple enough for reasonably easy processing).</p>

<h3 id="conllu-module">conllu module</h3>

<p>Since we are now dealing with a standard format, we can also simply use
an existing Python package designed for working with CoNLL-U files,
which is called <code class="language-plaintext highlighter-rouge">conllu</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">conllu</span>
</code></pre></div></div>

<p>```python tags=[“output_scroll”]
the_output = response.json()[‘result’]
sentences = conllu.parse(the_output)
sentences</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
This way, we get the CoNLL-U data represented as Python objects, which
is much easier to work with than the original format.  We can see that
the data are represented as a list of sentences, where each sentence is
a `TokenList`.  Let's see just the first sentence.

```python tags=["output_scroll"]
sentences[0]
</code></pre></div></div>

<p>And let’s see just the sixth word from the first sentence.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sentences</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div></div>

<p>This shows us that the tokens themselves are represented as an
<code class="language-plaintext highlighter-rouge">OrderedDict</code>; which is just like a regular <code class="language-plaintext highlighter-rouge">dict</code> with a guaranteed
order of its elements. Therefore, it is simple to only get e.g. the
word form and the Universal Part-of-speech tag for the word.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">sentences</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">][</span><span class="s">'form'</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">sentences</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">][</span><span class="s">'upostag'</span><span class="p">])</span>
</code></pre></div></div>

<h3 id="playing-with-the-output">Playing with the output</h3>

<p>What we now have is a fine and linguistically richly annotated output,
so there is a lot of things we can do with it. Let’s try a few!</p>

<p>Let’s e.g. try, for each token, to print its word form and its POS tag.</p>

<p>```python tags=[“output_scroll”]
for sentence in sentences:
    print(‘Writing out a sentence’, sentence)
    for token in sentence:
        print(“The UPOStag for”, token[‘form’], “is”, token[‘upostag’])</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Or, let's only print the nouns.

```python
for sentence in sentences:
    for token in sentence:
        if token['upostag'] == 'NOUN':
            print(token['form'])
</code></pre></div></div>

<h3 id="a-function">A function</h3>

<p>Let’s wrap the whole thing, including printing the nouns, into one
function.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">nouns</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s">'english'</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s">'http://lindat.mff.cuni.cz/services/udpipe/api/process'</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"data"</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span>
        <span class="s">"model"</span><span class="p">:</span> <span class="n">language</span><span class="p">,</span>
        <span class="s">"tokenizer"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">"tagger"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
    <span class="n">json_dict</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="n">text_result</span> <span class="o">=</span> <span class="n">json_dict</span><span class="p">[</span><span class="s">'result'</span><span class="p">]</span>
    <span class="n">conllu_result</span> <span class="o">=</span> <span class="n">conllu</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">text_result</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="n">conllu_result</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">sentence</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">token</span><span class="p">[</span><span class="s">'upostag'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'NOUN'</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">token</span><span class="p">[</span><span class="s">'form'</span><span class="p">])</span>
</code></pre></div></div>

<p>And let’s invoke the function.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nouns</span><span class="p">(</span><span class="s">"My hovercraft is full of eels."</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nouns</span><span class="p">(</span><span class="s">"Moje vznášedlo je plné úhořů."</span><span class="p">,</span> <span class="s">'czech'</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="additional-exercises-6">Additional exercises 6</h3>

<ul>
  <li>Try to join multiple REST APIs together, e.g.
    <ul>
      <li>Get a joke in English</li>
      <li>Translate it to French</li>
      <li>Print out the morphological analysis of the joke in French; or e.g.
only print the French nouns from the joke</li>
      <li>Ideally, these should be three separate functions for each of the
REST APIs, plus one wrapper function that calls the other functions
and passes the results from one as the input to the other.</li>
      <li>Observe how you have just managed to do three non-trivial tasks with
just a few lines of code, thanks to the fact that the authors of the
tools made them available through a REST API, and thanks to the fact
that working with REST APIs is quite simple in Python.</li>
    </ul>
  </li>
  <li>Look for other REST APIs and try to use some of them
    <ul>
      <li><a href="https://github.com/toddmotto/public-apis/blob/master/README.md">A list of free REST
APIs</a>,
such as <a href="https://alexwohlbruck.github.io/cat-facts/docs/">Cat facts</a></li>
      <li>Many NLP tools and services are also available through REST APIs</li>
      <li>Sometimes you have to register, sometimes you have to pay…</li>
      <li>Often the documentation is scarce, confusing or non-existent, so you
simply have to try out things and see what results you are getting.</li>
    </ul>
  </li>
</ul>

            </div>
            <div class="c-textbook__footer" id="textbook_footer">
              
<nav class="c-page__nav">
  

  
</nav>

              <footer>
  <p class="footer">Sponsored by <a href="https://www.visegradfund.org/">Visegrad Fund</a> grant nr. 21820079 "Training Digital Scholars: Knowledge Exchange between V4 and Austria"</p>
</footer>

            </div>

        </div>
      </main>
    </div>
  </body>
</html>
